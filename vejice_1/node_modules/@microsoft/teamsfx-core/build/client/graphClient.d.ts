/// <reference types="node" />
import { FxError, LogProvider, M365TokenProvider, Result, SensitivityLabel } from "@microsoft/teamsfx-api";
import { CreateChannelResponse } from "./interfaces/CreateChannelResponse";
import { CreateTeamAndChannelResponse } from "./interfaces/CreateTeamAndChannelResponse";
import { GetAppInstallationResponse } from "./interfaces/GetAppInstallationResponse";
import { GetChannelResponse } from "./interfaces/GetChannelResponse";
import { Group } from "./interfaces/GetGroupResponse";
import { GetJoinedTeamsResponse } from "./interfaces/GetJoinedTeamsResponse";
import { GetTeamsAppSettingsResponse } from "./interfaces/GetTeamsAppSettingsResponse";
import { User } from "./interfaces/GetUserResponse";
export declare class RetryHandler {
    static RETRIES: number;
    static Retry<T>(fn: () => Promise<T>): Promise<T | undefined>;
}
export declare class GraphClient {
    private readonly baseUrl;
    private readonly tokenProvider;
    private readonly logProvider;
    constructor(tokenProvider: M365TokenProvider, logProvider?: LogProvider);
    private createRequesterWithToken;
    listSensitivityLabels(token: string, useCache?: boolean): Promise<Result<SensitivityLabel[], FxError>>;
    getGeneralSentivityLabel(token: string): Promise<Result<SensitivityLabel, FxError>>;
    private buildCacheKey;
    /**
     * Get sandboxing configuration of team app settings.
     * @returns
     */
    GetTeamsAppSettingsAsync(): Promise<GetTeamsAppSettingsResponse>;
    GetJoinedSandboxedTeamsAsync(): Promise<GetJoinedTeamsResponse>;
    /**
     * Get weburl of a channel.
     * @param teamId
     * @param channelId
     * @returns
     */
    GetChannelDeeplinkAsync(teamId: string, channelId: string): Promise<string>;
    /**
     * Install Teams app package into a channel.
     * @param teamId
     * @param channelId
     * @param file Teams app package zip file
     */
    InstallAppToChannelAsync(teamId: string, channelId: string, file: Buffer): Promise<void>;
    /**
     * Get installed apps in a team.
     * @param teamId
     * @returns An array of installed apps, the externalId is the Teams app id.
     */
    GetAppInstallationForTeam(teamId: string): Promise<GetAppInstallationResponse[]>;
    DeleteInstalledApp(teamId: string, installationId: string): Promise<void>;
    /**
     * Create a sandboxed team and a channel.
     * @param teamName Team name
     * @param description Team description
     * @param defaultChannelName Channel name
     * @returns
     */
    CreateTeamAndChannelAsync(teamName: string, description: string, defaultChannelName: string): Promise<CreateTeamAndChannelResponse>;
    CreateChannelAsync(teamId: string, channelName: string, description: string): Promise<CreateChannelResponse>;
    /**
     * List channels in a team
     * @param teamId Team ID
     * @returns A list of channels, with id and webUrl
     */
    GetChannelsInTeamAsync(teamId: string): Promise<GetChannelResponse[]>;
    /**
     * Get current user info
     * @returns unique name and tenant id in string array
     */
    getCurrentUserInfo(): Promise<string[]>;
    getUserInfoFromId(id: string): Promise<User | undefined>;
    getGroupInfo(email: string): Promise<Group | undefined>;
}
//# sourceMappingURL=graphClient.d.ts.map