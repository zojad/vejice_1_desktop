import { FxError, LogProvider, Result } from "@microsoft/teamsfx-api";
import { AppUser } from "../driver/teamsApp/interfaces/appdefinitions/appUser";
import { M365AppDefinition, M365AppEntity } from "./interface";
export declare enum AppScope {
    Personal = "Personal",
    Shared = "Shared",
    Tenant = "Tenant"
}
export declare const AgentPermission: {
    name: string;
    owner: string;
    type: string;
};
export declare class PackageService {
    private static sharedInstance;
    private readonly axiosInstance;
    private readonly initEndpoint;
    private readonly logger;
    static GetSharedInstance(): PackageService;
    constructor(endpoint: string, logger?: LogProvider);
    getTitleServiceUrl(token: string): Promise<string>;
    sideLoadXmlManifest(token: string, manifestPath: string): Promise<[string, string]>;
    sideLoading(token: string, packagePath: string, appScope?: AppScope): Promise<[string, string, string]>;
    sideLoadingV2(token: string, manifestPath: string, appScope: AppScope): Promise<[string, string]>;
    sideLoadingV1(token: string, manifestPath: string): Promise<[string, string]>;
    getShareLink(token: string, titleId: string): Promise<string>;
    getLaunchInfoByManifestId(token: string, manifestId: string): Promise<any>;
    retrieveTitleId(token: string, manifestId: string): Promise<string>;
    retrieveAppId(token: string, manifestId: string): Promise<string | undefined>;
    unacquire(token: string, titleId: string): Promise<void>;
    getLaunchInfoByTitleId(token: string, titleId: string): Promise<unknown>;
    getActiveExperiences(token: string, ensureUpToDate?: boolean): Promise<string[] | undefined>;
    removePermission(token: string, titleId: string, user: AppUser): Promise<Result<undefined, FxError>>;
    addOwner(token: string, titleId: string, user: AppUser): Promise<Result<undefined, FxError>>;
    shareWithTenant(token: string, titleId: string): Promise<Result<undefined, FxError>>;
    getSharedUsers(token: string, titleId: string): Promise<Result<M365AppEntity[], FxError>>;
    shareWithUsers(token: string, entities: M365AppEntity[], titleId: string, appId?: string): Promise<Result<undefined, FxError>>;
    unshare(token: string, titleId: string): Promise<Result<undefined, FxError>>;
    previewApp(token: string, titleId: string): Promise<Result<M365AppDefinition, FxError>>;
    getCopilotStatus(token: string, ensureUpToDate?: boolean): Promise<boolean | undefined>;
    private isExistingUser;
    private traceError;
    private checkZip;
    private getManifestFromZip;
}
//# sourceMappingURL=packageService.d.ts.map