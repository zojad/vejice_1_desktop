/// <reference types="node" />
import { FxError, InputsWithProjectPath, ManifestCapability, Result, TeamsAppManifest, TeamsManifest } from "@microsoft/teamsfx-api";
import "reflect-metadata";
import { DriverContext } from "../../interface/commonArgs";
export declare const SharePointAppId = "00000003-0000-0ff1-ce00-000000000000";
export interface ManifestCommonProperties {
    /**
     * Capabilities, e.g. "staticTab" | "configurableTab" | "MessageExtension" | "WebApplicationInfo" | "plugin" | "copilotGpt"
     */
    capabilities: string[];
    /**
     * Teams app id
     */
    id: string;
    /**
     * Teams app version, e.g.1.0.0
     */
    version: string;
    /**
     * manifest version, e.g. 1.16
     */
    manifestVersion: string;
    /**
     * Whether it's an API ME
     */
    isApiME: boolean;
    /**
     * Whether it's SPFx Teams app
     */
    isSPFx: boolean;
    /**
     * Whether it's an API ME with AAD auth
     */
    isApiMeAAD: boolean;
}
export declare class ManifestUtils {
    readAppManifest(projectPath: string): Promise<Result<TeamsAppManifest, FxError>>;
    readAppManifestSync(projectPath: string): Result<TeamsAppManifest, FxError>;
    _readAppManifest(manifestTemplatePath: string): Promise<Result<TeamsAppManifest, FxError>>;
    _writeAppManifest(appManifest: TeamsAppManifest, manifestTemplatePath: string): Promise<Result<undefined, FxError>>;
    getTeamsAppManifestPath(projectPath: string): string;
    addCapabilities(inputs: InputsWithProjectPath, capabilities: ManifestCapability[], isM365?: boolean): Promise<Result<undefined, FxError>>;
    _capabilityExceedLimit(manifest: TeamsAppManifest, capability: "staticTab" | "configurableTab" | "Bot" | "MessageExtension" | "WebApplicationInfo"): boolean;
    getCapabilities(template: TeamsAppManifest): string[];
    /**
     * Get command id from composeExtensions
     * @param manifest
     */
    getOperationIds(manifest: TeamsAppManifest): string[];
    getPluginFilePath(manifest: TeamsAppManifest, manifestPath: string): Promise<Result<string, FxError>>;
    getManifestV3(manifestTemplatePath: string, context: DriverContext, generateIdIfNotResolved?: boolean): Promise<Result<TeamsManifest, FxError>>;
    extractManifestFromArchivedFile(archivedFile: Buffer): Result<TeamsAppManifest, FxError>;
    /**
     * trim the short name in manifest to make sure it is no more than 25 length
     */
    trimManifestShortName(projectPath: string, maxLength?: number): Promise<Result<undefined, FxError>>;
    resolveLocFile(locFilePath: string): Promise<Result<string, FxError>>;
    /**
     * Parse the manifest and get properties
     * @param manifest
     */
    parseCommonProperties(manifest: TeamsAppManifest): ManifestCommonProperties;
    /**
     * Parse the manifest and get telemetry propreties e.g. appId, capabilities etc.
     * @param manifest
     * @returns Telemetry properties
     */
    parseCommonTelemetryProperties(manifest: TeamsAppManifest): {
        [p: string]: string;
    };
}
export declare const manifestUtils: ManifestUtils;
//# sourceMappingURL=ManifestUtils.d.ts.map